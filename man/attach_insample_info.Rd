% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/robularized_SSM.R
\name{attach_insample_info}
\alias{attach_insample_info}
\title{Attach In-Sample Information to Fitted State Space Model}
\usage{
attach_insample_info(model, build)
}
\arguments{
\item{model}{A fitted model object of class `"robularized_SSM"`, `"classical_SSM"`, `"oracle_SSM"`, `"huber_robust_SSM"`, or `"trimmed_robust_SSM"`, as returned by functions such as [robularized_SSM()], [classical_SSM()], [oracle_SSM()], [huber_robust_SSM()], or [trimmed_robust_SSM()].}

\item{build}{A function that takes a numeric parameter vector and returns a `dlm` model object, as used during model fitting.}
}
\value{
A modified version of the input model object, with an additional class `"insample_info"`, and the following in-sample elements appended:
\describe{
  \item{`filtered_states`}{Filtered state estimates using data up to each time point.}
  \item{`predicted_states`}{One-step-ahead state predictions.}
  \item{`filtered_observations`}{Expected observations given data up to each time point.}
  \item{`predicted_observations`}{One-step-ahead forecasts of observations.}
  \item{`filtered_states_var`}{List of filtered state variance matrices.}
  \item{`predicted_states_var`}{List of one-step-ahead state prediction variances.}
  \item{`predicted_observations_var`}{List of one-step-ahead observation forecast variances.}
  \item{`mahalanobis_residuals`}{Vector of Mahalanobis distances of residuals from predicted observations.}
}

For models of class `"robularized_SSM"`, `"classical_SSM"`, or `"oracle_SSM"`, the following additional elements are also attached:
\describe{
  \item{`smoothed_states`}{Posterior means of hidden states using all data.}
  \item{`smoothed_observations`}{Posterior mean of the observed series based on smoothed states.}
  \item{`smoothed_states_var`}{List of smoothed state variance matrices.}
}
}
\description{
Attaches detailed in-sample outputs—such as predicted, filtered, and smoothed states and observations—to a model object fitted using any of the package’s supported estimation methods.
These quantities are not stored by default in model objects due to their potentially large memory footprint.
}
\details{
The attached outputs enable richer diagnostics, outlier inspection, and plotting.
For `"huber_robust_SSM"` and `"trimmed_robust_SSM"` models, in-sample information is computed using a custom robust filtering function, and smoothed quantities (`smoothed_states`, `smoothed_observations`, and `smoothed_states_var`) are **not available**.
This function should only be applied once to a model object.
}
