<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Robust Regularized Fitting of State Space Models — robularized_SSM • roams</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Robust Regularized Fitting of State Space Models — robularized_SSM"><meta name="description" content="Fits a robust state space model to multivariate time series data using iterative parameter estimation and outlier detection. This procedure is inspired by the Iterative Procedure for Outlier Detection (IPOD) algorithm of She and Owen (2011) and is applied over a sequence of regularization parameters (\(\lambda\)'s), identifying outliers via Mahalanobis residuals and re-fitting the model iteratively."><meta property="og:description" content="Fits a robust state space model to multivariate time series data using iterative parameter estimation and outlier detection. This procedure is inspired by the Iterative Procedure for Outlier Detection (IPOD) algorithm of She and Owen (2011) and is applied over a sequence of regularization parameters (\(\lambda\)'s), identifying outliers via Mahalanobis residuals and re-fitting the model iteratively."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">roams</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/dcrw_examples.html">DCRW examples</a></li>
    <li><a class="dropdown-item" href="../articles/sim1.html">Simulation study 1</a></li>
    <li><a class="dropdown-item" href="../articles/sim2.html">Simulation study 2</a></li>
    <li><a class="dropdown-item" href="../articles/sim3.html">Simulation study 3</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/rajan-shankar/roams/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Robust Regularized Fitting of State Space Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/rajan-shankar/roams/blob/HEAD/R/robularized_SSM.R"><code>R/robularized_SSM.R</code></a></small>
      <div class="d-none name"><code>robularized_SSM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a robust state space model to multivariate time series data using iterative parameter estimation and outlier detection. This procedure is inspired by the Iterative Procedure for Outlier Detection (IPOD) algorithm of She and Owen (2011) and is applied over a sequence of regularization parameters (\(\lambda\)'s), identifying outliers via Mahalanobis residuals and re-fitting the model iteratively.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">robularized_SSM</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">init_par</span>,</span>
<span>  <span class="va">build</span>,</span>
<span>  num_lambdas <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  custom_lambdas <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  lower <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>parscale <span class="op">=</span> <span class="va">init_par</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A numeric matrix of observations, with each row corresponding to a time point.</p></dd>


<dt id="arg-init-par">init_par<a class="anchor" aria-label="anchor" href="#arg-init-par"></a></dt>
<dd><p>A numeric vector of initial parameter values for optimization.</p></dd>


<dt id="arg-build">build<a class="anchor" aria-label="anchor" href="#arg-build"></a></dt>
<dd><p>A function that accepts a parameter vector and returns a <code>dlm</code> model (as used in <code><a href="https://rdrr.io/pkg/dlm/man/dlmMLE.html" class="external-link">dlm::dlmMLE()</a></code>). The <code>specify_SSM</code> function can be used to create this <code>build</code> function.</p></dd>


<dt id="arg-num-lambdas">num_lambdas<a class="anchor" aria-label="anchor" href="#arg-num-lambdas"></a></dt>
<dd><p>Integer. The number of \(\lambda\) values to evaluate. Ignored if <code>custom_lambdas</code> is specified. Default is 20.</p></dd>


<dt id="arg-custom-lambdas">custom_lambdas<a class="anchor" aria-label="anchor" href="#arg-custom-lambdas"></a></dt>
<dd><p>Optional numeric vector. If supplied, these are the exact \(\lambda\) values used for model fitting. If not provided or set to <code>NA</code>, then <code>num_lambdas</code> \(\lambda\)'s are automatically chosen.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Integer. Number of CPU cores to use for parallel processing. Default is 1 (sequential execution).</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Integer. Maximum number of IPOD iterations per \(\lambda\). Default is 50.</p></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>Optional numeric vector of lower bounds for optimization. If <code>NA</code>, defaults to <code>-Inf</code> for all parameters. Must be of same length as <code>init_par</code>.</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>Optional numeric vector of upper bounds for optimization. If <code>NA</code>, defaults to <code>Inf</code> for all parameters. Must be of same length as <code>init_par</code>.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A named list of control options to pass to <code>optim</code> via <code><a href="https://rdrr.io/pkg/dlm/man/dlmMLE.html" class="external-link">dlm::dlmMLE()</a></code>. Default is <code>list(parscale = init_par)</code>, which can help the optimizer if parameters are on vastly different scales.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If more than one \(\lambda\) values are used, returns an object of class <code>robularized_SSM_list</code> — a list containing a <code>robularized_SSM</code> model for each \(\lambda\). If only one \(\lambda\) value is used (i.e. <code>custom_lambdas</code> is manually specified as a single value), returns a single <code>robularized_SSM</code> object.</p>
<p>Each <code>robularized_SSM</code> object includes:</p><ul><li><p><code>lambda</code> - The \(\lambda\) value used.</p></li>
<li><p><code>prop_outlying</code> - Proportion of non-missing time points identified as outliers.</p></li>
<li><p><code>BIC</code> - Bayesian Information Criterion of the final model.</p></li>
<li><p><code>loglik</code> - Log-likelihood of the fitted model.</p></li>
<li><p><code>RSS</code> - Residual sum of squares.</p></li>
<li><p><code>gamma</code> - Matrix of estimated outlier adjustments.</p></li>
<li><p><code>iterations</code> - Number of IPOD iterations performed.</p></li>
<li><p>Optimization output from <code><a href="https://rdrr.io/pkg/dlm/man/dlmMLE.html" class="external-link">dlm::dlmMLE()</a></code> from the final IPOD iteration.</p></li>
<li><p><code>y</code> - The original data matrix.</p></li>
<li><p><code>build</code> - The original build function used to specify the model.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The IPOD procedure alternates between estimating model parameters via maximum likelihood and identifying outlying observations based on Mahalanobis residuals. For each iteration:</p><ol><li><p>A <code>dlm</code> model is fit using <code><a href="https://rdrr.io/pkg/dlm/man/dlmMLE.html" class="external-link">dlm::dlmMLE()</a></code>.</p></li>
<li><p>Mahalanobis residuals are computed.</p></li>
<li><p>Observations with residuals above the current \(\lambda\) threshold are treated as missing in the next iteration.</p></li>
</ol><p>The algorithm stops when the change in parameters and outlier estimates is sufficiently small or if too many outliers are detected (more than 50% of complete observations).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>She, Y., &amp; Owen, A. B. (2011). Outlier Detection Using Nonconvex Penalized Regression. *Journal of the American Statistical Association, 106*(494), 626–639. https://doi.org/10.1198/jasa.2011.tm10390</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/dlm/man/dlmMLE.html" class="external-link">dlmMLE</a></code>, <code><a href="best_BIC_model.html">best_BIC_model</a></code>, <code><a href="outlier_target_model.html">outlier_target_model</a></code>, <code><a href="get_attribute.html">get_attribute</a></code>, <code><a href="autoplot.robularized_SSM_list.html">autoplot.robularized_SSM_list</a></code>, <code><a href="attach_insample_info.html">attach_insample_info</a></code>, <code><a href="oos_filter.html">oos_filter</a></code>, <code><a href="specify_SSM.html">specify_SSM</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rajan Shankar, Garth Tarr, Ines Wilms, Jakob Raymaekers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

